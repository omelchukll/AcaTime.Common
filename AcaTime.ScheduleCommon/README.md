# AcaTime.ScheduleCommon

Бібліотека базових компонентів для роботи з розкладом занять у системі AcaTime. Містить моделі даних, інтерфейси, сервіси та утиліти, необхідні для генерації та обробки розкладу.

## Структура проекту

Проект має наступну структуру:

- **Abstract** - Інтерфейси для основних компонентів системи
- **Models** - Моделі даних для роботи з розкладом
  - **Api** - Моделі для обміну даними з API сервера
  - **Calc** - Моделі для обчислень та роботи алгоритмів
  - **Constraints** - Моделі для обмежень та оцінок розкладу
- **Services** - Сервіси для роботи з розкладом
- **Utils** - Допоміжні утиліти та розширення

## Інтерфейси (Abstract)

- **IScheduleAlgorithm** - Базовий інтерфейс для алгоритмів генерації розкладу
- **IApiClient** - Інтерфейс для роботи з API сервера
- **IScheduleProcessor** - Інтерфейс для обробки розкладу

## Моделі даних

### Моделі Calc

Основні моделі для роботи алгоритмів генерації розкладу:

- **FacultySeasonDTO** - Дані про семестр факультету, головна модель, що містить усі інші сутності
- **SubjectDTO** - Навчальний предмет з усіма властивостями
- **GroupSubjectDTO** - Зв'язок групи студентів з предметом
- **StudentLessonGroupDTO** - Група студентів
- **TeacherDTO** - Дані про викладача
- **ClassroomDTO** - Дані про аудиторію
- **ScheduleSlotDTO** - Слот розкладу, заняття для заданої групи за заданим предметом, викладачем в визначений час в визначеній аудиторії 
- **AssignedSlotsDTO** - Призначені слоти для предметів
- **SlotEstimationDTO** - Оцінка слотів для алгоритму розподілу
- **AlgorithmResultDTO** - Результат роботи алгоритму
- **AlgorithmParameterDTO** - Параметр алгоритму з описом та значенням
- **SubjectSeriesDTO** - Серія занять, що проводяться за певним регулярним графіком

Ключові зв'язки:
- **FacultySeasonDTO** містить колекції **StudentLessonGroupDTO**, **TeacherDTO**, **ClassroomDTO**, **SubjectDTO**
- **GroupSubjectDTO** пов'язує **StudentLessonGroupDTO** та **SubjectDTO**
- **ScheduleSlotDTO** містить посилання на **GroupSubjectDTO**, **TeacherDTO**, **ClassroomDTO**
- **AssignedSlotsDTO** містить колекцію призначених **ScheduleSlotDTO**

## Концепція серій у розкладі

Серія (**SubjectSeriesDTO**) - це набір слотів з одного групового предмету, які проводяться:
- в один і той самий день тижня
- на одній і тій самій парі
- в ідеалі (але не обов'язково) кожний або через тиждень
- в ідеалі (але не обов'язково) в одній і тій самій аудиторії

Серії використовуються для забезпечення регулярності розкладу та зручності як для студентів, так і для викладачів. Наприклад, лекції з математики можуть проводитися щопонеділка на першій парі протягом усього семестру.

Деякі серії можуть бути заданні користувачем в SubjectDTO. Інші повинні бути сформовані алгоритмом з урахуванням обмежень.

### Моделі Constraints

Моделі для роботи з обмеженнями та оцінками розкладу:

- **UserFunctions** - Контейнер для користувацьких функцій оцінки та перевірки
- **BaseConstraint** - Базовий клас для обмежень
- **ScheduleSlotValidation** - Функція перевірки валідності слоту відносно вже визначених слотів
- **ScheduleSlotValueEstimation** - Евристика. Функція оцінки пропозиції часу для слоту відносно вже визначених слотів
- **ScheduleEstimation** - Функція оцінки всього розкладу
- **SlotEstimation** - Евристика. Оцінка вибору наступного слоту для визначення
- **UnitaryConstraint** - Унітарне (абсолютне) обмеження для слотів

> **Важливе попередження**: Користувацькі функції не містять тривіальних обмежень щодо одночасного заняття для одного викладача, студента або аудиторії. Ці перевірки алгоритм повинен виконувати самостійно!

## Використання в алгоритмах

При розробці власного алгоритму генерації розкладу ви отримуєте екземпляр `UserFunctions`, який містить усі користувацькі функції, та дані про семестр у вигляді `FacultySeasonDTO`. Ваш алгоритм може використовувати ці функції для оцінки слотів та перевірки обмежень під час генерації розкладу.

## Взаємодія з API сервером

Бібліотека містить моделі для обміну даними з API сервером у просторі імен `Models.Api`. Ці моделі використовуються для отримання даних від сервера та відправки результатів роботи алгоритмів. 